var DW = DW || {};
DW.Util = function () {
    this.testVersion = location.href.indexOf("dev2.dasselundwagner.de") >= 0;
    this.isIosTouch = navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/iPad/i);
    this.isIPhone = navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i);
    this.isTouch = Modernizr.touch;
    this.isIE8 = $("html").hasClass("ie8");
    this.isMac = navigator.appVersion.indexOf("Mac") !== -1;
    this.getWindowHeight = function () {
        var e = $(window).height();
        this.isIPhone && e !== 320 && "standalone" in window.navigator && !window.navigator.standalone && (e += 60);
        return e
    };
    this.adjustVerticalCenteredDivs = function () {
        $(".vertical-middle").each(function () {
            var e = $(this),
                t = e.parent();
            e.css("top", (t.height() - e.height()) / 2)
        })
    };
    this.clearSelection = function () {
        window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()
    };
    this.handleExclusive = function (e, t, n) {
        e.preventDefault();
        e.stopPropagation();
        t(n)
    };
    this.toggleLanguage = function () {
        this.testVersion ? DW.LANGUAGE === "de" ? location.href = DW.TEST_URL + "/en" : location.href = DW.TEST_URL + "/de" : DW.LANGUAGE === "de" ? location.href = DW.LIVE_URL + "/en" : location.href = DW.LIVE_URL + "/de"
    }
};
DW.util = new DW.Util;
$(document).ready(function () {
    if (Modernizr.touch) return;
    $("img.rollover").hover(function () {
        this.src = this.src.replace("_off", "_on")
    }, function () {
        this.src = this.src.replace("_on", "_off")
    })
});
$.fn.preload = function () {
    this.each(function () {
        $("<img/>")[0].src = this
    })
};
var DW = DW || {};
DW.Debug = function () {
    function t() {
        $("body").append('<div id="touch-console"></div>');
        $(".logo").on("touchend", function () {
            $("#touch-console").toggle()
        })
    }

    function n() {
        window.console || (console = {
            log: function () {}
        })
    }
    var e = 0;
    $(document).ready(function () {
        DW.util.isTouch && t()
    });
    this.touchLog = function () {
        var t, r = e + ":";
        e++;
        for (t = 0; t < arguments.length; t++) r += " " + arguments[t];
        if (DW.util.isTouch) {
            $("#touch-console").append(r + "<br>");
            $("#touch-console").prop({
                scrollTop: $("#touch-console").prop("scrollHeight")
            })
        }
        n();
        console.log(r)
    }
};
if (DW.util.testVersion) {
    DW.debug = new DW.Debug;
    var tLog;
    tLog = DW.debug.touchLog
} else tLog = function () {};
var DW = DW || {};
DW.Navigation = function () {
    function o() {
        tLog("init DW.navigation ...");
        $(".view").each(function () {
            i.push($(this))
        });
        $(window).bind("scrollstart", function () {
            clearTimeout(s);
            DW.util.isTouch || $(".move-btn").stop().fadeOut(200)
        });
        $("#move-to-next-view").mousedown(function (t) {
            t.preventDefault();
            t.stopPropagation();
            $("html,body").stop();
            e.goNext()
        });
        $("#move-to-previous-view").mousedown(function (t) {
            t.preventDefault();
            t.stopPropagation();
            $("html,body").stop();
            e.goBack()
        });
        $(window).bind("mousewheel", function (i, s) {
            i.preventDefault();
            if (!n) {
                r = s;
                n = !0;
                t = setTimeout(function () {
                    n = !1;
                    r = 0
                }, 800)
            } else r += s; if (Math.abs(r) > 2) {
                r > 2 && e.goBack();
                r < -2 && e.goNext();
                clearTimeout(t);
                n = !1;
                r = 0
            }
        });
        $(document).keydown(function (t) {
            var n = t.keyCode || t.which,
                r = {
                    left: 37,
                    up: 38,
                    right: 39,
                    down: 40
                };
            switch (n) {
            case r.left:
                e.goBack();
                break;
            case r.up:
                e.goBack();
                break;
            case r.right:
                e.goNext();
                break;
            case r.down:
                e.goNext()
            }
        });
        $(window).bind("scrollstop", function () {
            DW.gui.adjustNaviButtons();
            if ($("html:animated,body:animated").length > 0) return;
            if (DW.resize.resizing) return;
            if (n) return;
            typeof DW.dragPage != "undefined" && DW.dragPage.resetMouseDown();
            var t = e.getViewInWindow();
            clearTimeout(s);
            s = setTimeout(function () {
                e.moveToView(t, DW.SCROLL_STOP_DURATION, DW.SCROLL_STOP_DURATION, DW.SCROLL_STOP_EASING)
            }, 500)
        })
    }
    var e = this,
        t, n = !1,
        r, i = [],
        s;
    this.currentView = $(".view").first();
    this.viewChangedTime = 0;
    o();
    this.moveToView = function (t, n, r, s) {
        r = typeof r != "undefined" ? r : 0;
        s = typeof s != "undefined" ? s : "easeOutQuint";
        var o, u, a, f = $(window).width(),
            l, c = Math.max($("html").scrollLeft(), $("body").scrollLeft());
        o = $(".view").index(t) * (f + 1) + 1;
        if (o === c) return;
        u = e.currentView !== t;
        e.currentView = t;
        DW.menu.hideMenuLevel2();
        DW.gui.setGuiColors();
        $("body").css("background-color", t.css("background-color"));
        DW.gui.visualizeCurrentChapter();
        DW.layer.onStartViewChange();
        l = Math.abs((o - c) / f);
        a = n + Math.floor(r * (l / i.length));
        $("html,body").stop().animate({
            scrollLeft: o
        }, {
            duration: a,
            easing: s,
            always: function () {
                var t = (new Date).getTime();
                if (t - e.viewChangedTime > 100 && u) {
                    DW.layer.onViewChanged();
                    DW.layer.closeInvisibleLayer();
                    DW.imageLoader.onViewChanged()
                }
                e.viewChangedTime = t
            }
        })
    };
    this.goNext = function () {
        var t;
        t = e.currentView.next(".view");
        t.length > 0 && e.moveToView(t, DW.MOVE_LEFT_RIGHT_DURATION, DW.MOVE_LEFT_RIGHT_DURATION, DW.MOVE_LEFT_RIGHT_EASING)
    };
    this.goBack = function () {
        var t;
        t = e.currentView.prev(".view");
        t.length > 0 && e.moveToView(t, DW.MOVE_LEFT_RIGHT_DURATION, DW.MOVE_LEFT_RIGHT_DURATION, DW.MOVE_LEFT_RIGHT_EASING)
    };
    this.getViewInWindow = function () {
        var e = Math.max($("html").scrollLeft(), $("body").scrollLeft()),
            t = e + $(window).width() / 2,
            n, r = 0,
            s = 99999;
        for (n = 0; n < i.length; n++)
            if (Math.abs(i[n].offset().left - t) < Math.abs(s)) {
                s = i[n].offset().left - t;
                r = n
            }
        s > 0 && (r = Math.max(r - 1, 0));
        return i[r]
    };
    this.moveToFirstView = function () {
        e.moveToView($(".view").first(), 0)
    }
};
$(document).ready(function () {
    DW.navigation = new DW.Navigation
});
var DW = DW || {};
DW.Gui = function () {
    function t() {
        var e = DW.navigation.currentView.prev(".view");
        return e.length === 0
    }

    function n() {
        var e = DW.navigation.currentView.next(".view");
        return e.length === 0
    }

    function r() {
        tLog("init DW.gui ...");
        e.adjustNaviButtons()
    }
    var e = this;
    this.logoColor = "white";
    this.adjustNaviButtons = function () {
        var r = $(window).width();
        if (DW.util.isTouch || r < 700) {
            $("#btn-next-touch").show();
            $("#move-to-previous-view").hide();
            $("#move-to-next-view").hide()
        } else {
            $("#btn-next-touch").hide();
            $("#move-to-previous-view").show();
            $("#move-to-next-view").show();
            if (e.logoColor === "black" && DW.navigation.currentView.attr("id") !== "view-home") {
                n() || $("#btn-next-black").stop(!0, !0).delay(200).fadeIn(500);
                t() || $("#btn-back-black").stop(!0, !0).delay(200).fadeIn(500)
            } else {
                n() || $("#btn-next-white").stop(!0, !0).delay(200).fadeIn(500);
                t() || $("#btn-back-white").stop(!0, !0).delay(200).fadeIn(500)
            }
        }
    };
    r();
    this.visualizeCurrentChapter = function () {
        var e = DW.navigation.currentView,
            t = $(e).data("chapter");
        $(".menu-status-bar").each(function (e) {
            e > t - 1 ? $(this).fadeOut(500) : $(this).fadeIn(500)
        });
        $("#chapter-title").text(e.data("chapterTitle"))
    };
    this.setGuiColors = function () {
        var t, n, r = DW.navigation.currentView;
        r.data("logo-color") !== undefined && (e.logoColor = r.data("logo-color"));
        e.logoColor === "#fff" || e.logoColor === "white" ? t = "#000" : t = "#fff";
        n = DW.navigation.currentView.css("background-color");
        $(".logo, .logo a").css("color", e.logoColor);
        $("#chapter-title").css("color", e.logoColor);
        $("#footer").css("color", e.logoColor);
        $(".menu-item").css("color", e.logoColor);
        $(".menu-status-bar").css("background-color", e.logoColor);
        $(".menu-triangle").css("border-top-color", e.logoColor);
        $(".menu-level2-triangle").css("border-left-color", e.logoColor);
        $(".menu-level2-item").css("color", e.logoColor);
        $(".menu-level2-item").css("background-color", n);
        $(".menu-level2-item").css("border-color", e.logoColor);
        $("#menu-level2, #menu-touch").css("border-color", e.logoColor);
        $(".menu-button-bar").css("background-color", e.logoColor);
        $(".menu-touch-item").css("background-color", n);
        $(".menu-touch-item").css("color", e.logoColor);
        $(".menu-touch-item").css("border-color", e.logoColor);
        $(".menu-touch-triangle").css("border-left-color", e.logoColor);
        if (DW.navigation.currentView.attr("id") === "view-home") {
            $(".logo, .logo a").css("color", "#fff");
            $("#chapter-title").css("color", "#fff");
            $("#footer").css("color", "#fff");
            $(".menu-item").css("color", "#fff");
            $(".menu-button-bar").css("background-color", "#fff");
            $(".menu-status-bar").css("background-color", "#fff");
            $(".menu-triangle").css("border-top-color", "#fff");
            $(".menu-level2-item").css("background-color", "#fff");
            $(".menu-touch-item").css("background-color", "#fff")
        }
    }
};
$(document).ready(function () {
    DW.gui = new DW.Gui
});
var DW = DW || {};
DW.Menu = function () {
    function t() {
        tLog("init top menu ...");
        var t = DW.MENU,
            i, s = 0,
            o, u, a, f, l;
        for (i = 0; i < t.length; i++)
            if (t[i].level === 1) {
                u = "";
                o = DW.LANGUAGE === "en" ? t[i].labelEn : t[i].labelDe;
                i + 1 < t.length && t[i + 1].level === 2 && (u = '&nbsp;&nbsp;<div class="menu-triangle"></div>');
                $("#menu-list").append(' <li data-index="' + i + '" data-level1-index="' + s + '" data-view="' + t[i].view + '" ><span class="menu-item">' + o + "</span>" + u + '<div class="measure" style="display:inline-block"></div></li>');
                $("#menu-status").append('<div class="menu-status-bar"></div>');
                $("#view-" + t[i].view).data("chapterTitle", o);
                s++;
                i + 1 < t.length && t[i + 1].level === 2 ? DW.util.isTouch ? $("#menu li").last().on("touchstart", n) : $("#menu li").last().hover(n, r) : DW.util.isTouch && $("#menu li").last().on("touchstart", function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    DW.navigation.moveToView($("#view-" + $(this).data("view")), DW.NAVIGATION_SPEED_MIN, DW.NAVIGATION_SPEED_MAX)
                })
            }
        $("#menu-list").append('<li class="helper-line">&nbsp;</li>');
        $("#menu-list li").on("mouseup", function () {
            if (!DW.util.isTouch) {
                l = $("#view-" + $(this).data("view"));
                DW.navigation.moveToView(l, DW.NAVIGATION_SPEED_MIN, DW.NAVIGATION_SPEED_MAX);
                e.hideMenuLevel2()
            }
        });
        DW.util.isMac || $("#menu-list").css("line-height", "1em");
        a = 0;
        f = "";
        $(".view").each(function () {
            if ($(this).data("chapterTitle")) {
                a++;
                f = $(this).data("chapterTitle")
            }
            $(this).data("chapter", a);
            $(this).data("chapterTitle", f)
        })
    }

    function n() {
        var t = DW.MENU,
            n = $(this).data("index"),
            r = $(this).data("level1-index"),
            s, o, u, a = '<div class="menu-level2-triangle"></div>',
            f, l, c, h;
        e.hideMenuLevel2();
        if (DW.layer.layerOpen()) return;
        $("#header").append('<div id="menu-level2"></div>');
        f = $("#menu-level2");
        o = $(".menu-status-bar").eq(r).css("left");
        u = $(".menu-status-bar").eq(r).width();
        if (DW.MENU_LEVEL2_MINWIDTH > u) {
            o = parseInt(o, 10) - (DW.MENU_LEVEL2_MINWIDTH - u) + "px";
            u = DW.MENU_LEVEL2_MINWIDTH
        }
        f.width(u).css("left", o);
        f.append('<ul id="item-list"></ul>');
        c = $("#item-list");
        s = n + 1;
        while (t[s].level === 2) {
            h = DW.LANGUAGE === "en" ? t[s].labelEn : t[s].labelDe;
            c.append('<li class="menu-level2-item"" data-view="' + t[s].view + '">' + h + "&nbsp;&nbsp;" + a + "</li>");
            s++
        }
        $(".menu-level2-item").on("touchstart mousedown", function (t) {
            t.preventDefault();
            t.stopPropagation();
            l = $("#view-" + $(this).data("view"));
            DW.navigation.moveToView(l, DW.NAVIGATION_SPEED_MIN, DW.NAVIGATION_SPEED_MAX);
            e.hideMenuLevel2()
        });
        DW.gui.setGuiColors();
        f.hover(i, e.hideMenuLevel2)
    }

    function r() {
        clearTimeout(e.naviTimer);
        e.naviTimer = setTimeout(e.hideMenuLevel2, 500)
    }

    function i() {
        clearTimeout(e.naviTimer)
    }
    var e = this;
    this.naviTimer = 0;
    t();
    this.hideMenuLevel2 = function () {
        clearTimeout(e.naviTimer);
        $("#menu-level2").remove()
    };
    this.adjustMenuBars = function () {
        var e = 0;
        $(".measure").each(function (t) {
            $(".menu-status-bar").eq(t).css("left", e + "px").css("width", $(this).position().left - e - 1);
            e = $(this).position().left
        })
    }
};
$(document).ready(function () {
    DW.menu = new DW.Menu
});
var DW = DW || {};
DW.MenuTouch = function () {
    function t() {
        $("#menu-touch").css("visibility", "hidden") ? n() : e.hideMenu()
    }

    function n() {
        var t = DW.navigation.currentView;
        $("#menu-touch").css("visibility", "visible");
        $("#menu-touch").css("left", t.position().left + t.width() - $("#menu-touch").width() - .05 * $(window).width() + 1 + "px");
        DW.gui.setGuiColors();
        DW.layer.closeLayer();
        $("body").append('<div class="modal-touch"></div>');
        DW.util.isTouch ? $(".modal-touch").on("touchstart", e.hideMenu) : $(".modal-touch").on("mousedown", e.hideMenu);
        $(".modal-touch").css("left", $("body").scrollLeft())
    }

    function r(t) {
        var n;
        t.preventDefault();
        t.stopPropagation();
        n = $("#view-" + $(this).data("view"));
        DW.navigation.moveToView(n, DW.NAVIGATION_SPEED_MIN, DW.NAVIGATION_SPEED_MAX);
        e.hideMenu()
    }
    var e = this;
    this.init = function () {
        tLog("init touch menu ...");
        var e = DW.MENU,
            n, i;
        $("body").append('<div id="menu-touch"><ul id="menu-touch-list"></ul></div>');
        for (i = 0; i < e.length; i++)
            if (e[i].level === 1) {
                n = DW.LANGUAGE === "en" ? e[i].labelEn : e[i].labelDe;
                $("#menu-touch-list").append(' <li class="menu-touch-item" data-index="' + i + '" data-view="' + e[i].view + '" >' + n + '&nbsp;&nbsp;<div class="menu-touch-triangle"></div></li>')
            }
        DW.util.isTouch ? $(".menu-touch-item").on("touchstart", r) : $(".menu-touch-item").on("mousedown", r);
        DW.util.isIE8 && $("#menu-button").click(function () {
            t()
        })
    };
    this.onMenuButtonTouched = function () {
        t()
    };
    this.hideMenu = function () {
        $("#menu-touch").css("visibility", "hidden");
        $(".modal-touch").remove()
    }
};
$(document).ready(function () {
    DW.menuTouch = new DW.MenuTouch;
    DW.menuTouch.init()
});
var DW = DW || {};
DW.DragPage = function () {
    function i() {
        tLog("init DW.dragPage ...");
        if (!window.addEventListener) return;
        $("img").bind("dragstart", function (e) {
            e.preventDefault()
        });
        document.body.style.MozUserSelect = "none";
        DW.util.isTouch ? $(document).on("touchstart", s) : $(document).on("mousedown", s);
        $("body").bind("mouseleave", function () {
            r = !1
        })
    }

    function s(e) {
        var i, s;
        $("html,body").stop();
        t = DW.util.isTouch ? e.originalEvent.touches[0].pageX : e.clientX;
        n = Math.max($("html").scrollLeft(), $("body").scrollLeft());
        i = DW.util.isTouch ? t - n : e.clientX;
        s = DW.util.isTouch ? e.originalEvent.touches[0].pageY : e.clientY;
        if (DW.fixedElements.fixedPositionElementTouched(i, s)) return;
        DW.util.clearSelection();
        r = !0;
        if (DW.util.isTouch) {
            $(document).on("touchmove", o);
            $(document).on("touchend", u)
        } else {
            $(document).on("mousemove", o);
            $(document).on("mouseup", u)
        }
        var a = function (e) {
            e.preventDefault();
            e.stopPropagation();
            window.removeEventListener("click", a, !0)
        };
        window.addEventListener("click", a, !0)
    }

    function o(n) {
        n.originalEvent.preventDefault();
        n.originalEvent.stopPropagation();
        n.preventDefault();
        n.stopPropagation();
        var i = function (e) {
            e.preventDefault();
            e.stopPropagation();
            window.removeEventListener("click", i, !0)
        };
        window.addEventListener("click", i, !0);
        e = DW.util.isTouch ? n.originalEvent.touches[0].pageX : n.clientX;
        if (r) {
            window.scrollBy(t - e, 0);
            DW.util.isTouch || (t = e);
            return !1
        }
    }

    function u(e) {
        r = !1;
        e.originalEvent.preventDefault();
        e.preventDefault();
        var t = Math.max($("html").scrollLeft(), $("body").scrollLeft()) - n;
        t > DW.DRAG_MIN_DIFF && DW.navigation.goNext();
        t < -DW.DRAG_MIN_DIFF && DW.navigation.goBack();
        if (Math.abs(t) <= DW.DRAG_MIN_DIFF) {
            DW.navigation.moveToView(DW.navigation.getViewInWindow(), 500, 500, DW.SCROLL_STOP_EASING);
            var i = $(e.originalEvent.target).get(0),
                s = document.createEvent("MouseEvents");
            s.initMouseEvent("click", !0, !0, window, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null);
            i.dispatchEvent(s)
        }
        if (DW.util.isTouch) {
            $(document).off("touchmove", o);
            $(document).off("touchend", u)
        } else {
            $(document).off("mousemove", o);
            $(document).off("mouseup", u)
        }
        DW.util.clearSelection();
        return !1
    }
    var e = 0,
        t = 0,
        n = 0,
        r = !1;
    i();
    this.resetMouseDown = function () {
        r = !1;
        $(document).off("mousemove", o)
    }
};
$(document).ready(function () {
    DW.dragPage = new DW.DragPage
});
var DW = DW || {};
DW.FixedElements = function () {
    function e(e, t, n, r, i, s, o) {
        return (e.css("display") === "block" || e.css("display") === "inline-block") && s > t && s < t + r && o > n && o < n + i
    }
    this.fixedPositionElementTouched = function (t, n) {
        var r, i, s, o, u, a = DW.util.getWindowHeight(),
            f = $(window).width();
        r = $("#menu-button");
        i = r.position().left;
        s = r.offset().top;
        o = r.width();
        u = r.height();
        if (e(r, i, s, o, u, t, n)) {
            DW.menuTouch.onMenuButtonTouched();
            return !0
        }
        r = $("#impressum-link");
        i = f * .05;
        s = a * .95;
        o = r.width();
        u = a * .05;
        if (e(r, i, s, o, u, t, n)) {
            DW.layer.openImpressum();
            return !0
        }
        r = $("#language-select");
        i += o;
        o = r.width();
        if (e(r, i, s, o, u, t, n)) {
            DW.util.toggleLanguage();
            return !0
        }
        r = $("#facebook-link");
        i += o;
        o = r.width();
        if (e(r, i, s, o, u, t, n)) {
            window.open("https://www.facebook.com/dasselundwagner");
            return !0
        }
        return !1
    }
};
$(document).ready(function () {
    tLog("fixedElemetns ...");
    DW.fixedElements = new DW.FixedElements
});
var DW = DW || {};
DW.Layer = function () {
    function t() {
        tLog("init layers ..");
        var t, i;
        $(".view").each(function (e) {
            var n = $(this);
            if ($(".layer", n).length > 0) {
                t = $(".layer", n).first();
                i = $('<div class="cross-button" id="cross-' + e + '" data-view="' + n.attr("id") + '"><div class="animation-box"><div class="cross-h"></div><div class="cross-v"></div></div></div>');
                $("body").append(i);
                $(".cross-h, .cross-v", i).css("background-color", $(n).data("logo-color"));
                n.data("cross-id", i.attr("id"))
            }
            $(".cross-button").css("left", "-1000px")
        });
        $(".cross-button").on("touchstart mousedown", function (e) {
            DW.util.handleExclusive(e, n, $(this))
        });
        $("#impressum").append('<div class="cross-button"><div class="cross-h"></div><div class="cross-v"></div></div>');
        $("#impressum .cross-button").rotate(45);
        DW.util.isTouch ? $("#impressum .cross-button").on("touchstart", function () {
            e.closeLayer()
        }) : $("#impressum .cross-button").on("mousedown", function () {
            e.closeLayer()
        });
        DW.util.isTouch || $(".cross-button").mouseenter(function () {
            e.rotateCrossOnEnter && e.rotateCross($(this), -90, 250);
            e.rotateCrossOnEnter = !0;
            e.crossAnimation = !1
        });
        $(document).keydown(function (t) {
            var n = t.keyCode || t.which;
            n === 27 && e.closeLayer()
        });
        DW.util.isTouch ? $(document).on("touchstart", r) : $(document).on("mousedown", r)
    }

    function n(t) {
        var n, r, i, s, o;
        n = $("#" + t.data("view"));
        r = $(".layer", n);
        o = $(r).width() / DW.SQUARE_SIZE;
        i = $(".layer", n).clone(!0);
        $(i).css("visibility", "visible").css("left", $(r).offset().left + "px").css("z-index", "1000");
        $(i).addClass("top-layer");
        $(i).appendTo("body");
        s = t.clone();
        $(".cross-h, .cross-v", s).css("background-color", "#000");
        $(s).appendTo($(i));
        $(s).offset({
            top: t.offset().top,
            left: t.offset().left
        });
        setTimeout(function () {
            $(s).addClass("animate-375ms").rotate(135)
        }, 0);
        DW.util.isTouch ? $(s).on("touchstart", function () {
            e.closeLayer();
            event.preventDefault();
            event.stopPropagation()
        }) : $(s).on("mousedown", function () {
            e.closeLayer()
        });
        e.$topLayer = i
    }

    function r(t) {
        var n, r, i, s, o;
        if ($(".impressum-cover").length > 0) return;
        if (e.layerOpen()) {
            n = $(".layer").filter(function () {
                return $(this).css("visibility") === "visible"
            }).first();
            r = parseInt($(n).css("left"), 10);
            i = parseInt($(n).css("top"), 10);
            s = $(n).width();
            o = $(n).height();
            (t.pageX < r || t.pageX > r + s || t.pageY < i || t.pageY > i + o) && e.closeLayer()
        }
    }
    var e = this;
    this.crossAnimation = !0;
    this.rotateCrossOnEnter = !0;
    t();
    this.layerOpen = function () {
        return $(".layer").filter(function () {
            return $(this).css("visibility") === "visible"
        }).length > 0
    };
    this.closeLayer = function () {
        e.rotateCrossOnEnter = !1;
        $(".top-layer").remove();
        $(".layer").css("visibility", "hidden");
        $(".impressum-cover").remove();
        $(".cross-button").css("opacity", .9);
        setTimeout(function () {
            $(".cross-button").css("opacity", 1)
        }, 100)
    };
    this.closeInvisibleLayer = function () {
        var t = $(".layer").filter(function () {
            return $(this).css("visibility") === "visible"
        });
        t.each(function () {
            var t = $(window).scrollLeft(),
                n = t + $(window).width(),
                r = $(this).offset().left,
                i = r + $(this).width();
            if (!(i <= n && r >= t)) {
                e.closeLayer();
                return
            }
        })
    };
    this.openImpressum = function () {
        var t, n = DW.navigation.currentView;
        e.closeLayer();
        t = $(".square", n).first().offset().left;
        $("#impressum").css("visibility", "visible").css("left", t + "px");
        $("body").append('<div class="impressum-cover"></div>');
        $(".impressum-cover").css("left", n.css("left"))
    };
    this.onStartViewChange = function () {
        this.crossAnimation = !0
    };
    this.onViewChanged = function () {
        if (this.crossAnimation && !DW.util.isTouch) {
            var t = DW.navigation.currentView;
            t.data("cross-id") !== undefined && e.rotateCross($("#" + t.data("cross-id")), 180, 500)
        }
    };
    this.rotateCross = function (e, t, n) {
        var r = $(".animation-box", e);
        r.removeClass("animate-250ms animate-500ms");
        t !== 0 && r.rotate(0);
        setTimeout(function () {
            n === 250 && r.addClass("animate-250ms").rotate(t);
            n === 500 && r.addClass("animate-500ms").rotate(t)
        }, 0)
    }
};
$(document).ready(function () {
    DW.layer = new DW.Layer
});
var DW = DW || {};
DW.resize = function () {
    function u() {
        var n = DW.util.getWindowHeight(),
            r = $(window).width(),
            i, s, o, u, a, f, l;
        $(".view").height(n);
        $(".view").each(function (e) {
            $(this).css("left", e * (r + 1) + "px").css("top", 0).width(r + 1)
        });
        n < r ? t = Math.min(DW.SQUARE_SIZE, n) : t = Math.min(DW.SQUARE_SIZE, r);
        e = t / DW.SQUARE_SIZE;
        f = (n - t) / 2;
        a = (r - t) / 2;
        $(".square").each(function () {
            $(this).height(t);
            $(this).width(t);
            $(this).css("top", f + "px");
            if ($(".layer", $(this).parent()).length > 0) {
                l = $(".layer", $(this).parent()).first();
                l.css("left", a + "px")
            }
        });
        $(".layer").height(t).width(t).css("top", f + "px");
        $(".cross-button").each(function () {
            var n = 0;
            $(this).css("top", f + 32 * e + "px");
            $(this).data("view") !== undefined && (n = parseInt($("#" + $(this).data("view")).css("left"), 10));
            $(this).css("left", n + a + t - 96 * e + "px");
            $(this).width(64 * e).height(64 * e)
        });
        $("#impressum .cross-button").css("top", 32 * e + "px").css("left", t - 96 * e + "px");
        if (r / n > DW.BACKGROUND_ASPECTRATIO) {
            s = r;
            i = r / DW.BACKGROUND_ASPECTRATIO;
            o = 0;
            u = -((i - n) / 2)
        } else {
            i = n;
            s = n * DW.BACKGROUND_ASPECTRATIO;
            u = 0;
            o = -((s - r) / 2)
        }
        $(".view-background").height(i).width(s).css("left", o + "px").css("top", u + "px");
        var c = e * 100 + "%";
        $("body").css("font-size", c);
        r < 640 ? $("#header").css("padding-left", "5%").css("padding-right", "5%") : $("#header").css("padding-left", "32px").css("padding-right", "32px");
        DW.layer.closeLayer()
    }
    var e, t, n = 0,
        r = 0,
        i = -1,
        s, o = this;
    this.resizing = !1;
    this.onResize = function () {
        var e = DW.util.getWindowHeight(),
            t = $(window).width() + 1,
            a;
        if (Modernizr.touch) {
            a = e / t > 1 ? 1 : 0;
            if (Modernizr.touch && i >= 0) {
                a !== i && $(".view").css("opacity", 0).delay(1e3).animate({
                    opacity: 1
                }, 500);
                DW.menuTouch.hideMenu()
            }
            i = r / n > 1 ? 1 : 0
        } else {
            var f = ".view:not('#" + DW.navigation.currentView.attr("id") + "')";
            $(f).css("visibility", "hidden")
        }
        u();
        DW.menu.adjustMenuBars();
        DW.gui.adjustNaviButtons();
        DW.util.adjustVerticalCenteredDivs();
        DW.navigation.moveToView(DW.navigation.currentView, 0);
        o.resizing = !0;
        clearTimeout(s);
        s = setTimeout(function () {
            o.resizing = !1;
            $(".view").css("visibility", "visible")
        }, 1e3)
    };
    this.init = function () {
        tLog("init DW.resize ...");
        $(window).resize($.throttle(100, o.onResize));
        $(window).bind("orientationchange", function () {
            $(window).resize()
        })
    }
};
$(document).ready(function () {
    DW.resize = new DW.resize
});
$(window).load(function () {
    DW.resize.init()
});
var DW = DW || {};
DW.ImageLoader = function () {
    function n(e, t) {
        var n = new Image,
            r = e.closest(".view");
        n.onload = function () {
            e.hide();
            e.append('<img src="' + t + '"/>');
            e.fadeIn(500);
            $(".spinner", r).hide()
        };
        n.src = t
    }
    var e = this,
        t = [];
    this.init = function () {
        tLog("init imageLoader ...");
        var e;
        $(".image-box").each(function (n) {
            e = $(this);
            e.data("img-src") !== undefined && t.push({
                index: n,
                url: e.data("img-src")
            })
        })
    };
    this.loadNextImage = function () {
        var n, r = new Image;
        if (t.length > 0) {
            n = t.shift();
            r.onload = function () {
                var t = $(".image-box").eq(n.index),
                    r = t.closest(".view");
                t.append('<img src="' + n.url + '"/>');
                $(".spinner", r).hide();
                e.loadNextImage()
            };
            r.src = n.url
        }
    };
    this.onViewChanged = function () {
        var e, r = DW.navigation.currentView,
            i, s;
        for (e = t.length - 1; e >= 0; e--) {
            s = t[e];
            i = $(".image-box").eq(s.index);
            if (i.closest(r).length > 0) {
                t.splice(e, 1);
                n(i, s.url)
            }
        }
    }
};
$(document).ready(function () {
    DW.imageLoader = new DW.ImageLoader;
    DW.imageLoader.init()
});
var DW = DW || {};
$(document).ready(function () {
    DW.util.isIPhone && setTimeout(function () {
        window.scrollTo(0, 1)
    }, 2e3)
});
$(window).load(function () {
    tLog("window load ...");
    var e = 0;
    DW.util.isTouch && !DW.util.isIosTouch && (e = 3e3);
    setTimeout(function () {
        $("html, body").scrollLeft(0)
    }, 1e3);
    setTimeout(function () {
        DW.resize.onResize()
    }, 1e3 + e);
    $("#splash").delay(1500 + e).fadeOut(500);
    $(".view, #header").css("visibility", "visible").hide().delay(1500 + e).fadeIn(1e3);
    setTimeout(function () {
        $("#btn-next-white, #footer").css("visibility", "visible").hide().fadeIn(1e3)
    }, 2500 + e);
    setTimeout(function () {
        DW.menu.adjustMenuBars()
    }, 2500 + e);
    DW.util.isTouch || $(".view-background").css("position", "fixed");
    DW.gui.visualizeCurrentChapter();
    $(".link-button, .media-button").on("touchstart click", function (e) {
        DW.util.handleExclusive(e, function (e) {
            window.open(e.data("url"))
        }, $(this))
    });
    $(".logo a").on("touchstart click", function (e) {
        DW.util.handleExclusive(e, DW.navigation.moveToFirstView)
    });
    DW.util.isIE8 && $("#impressum-link").click(function () {
        DW.layer.openImpressum()
    });
    DW.util.adjustVerticalCenteredDivs();
    DW.imageLoader.loadNextImage();
    $(DW.PRELOAD_IMAGES).preload()
});